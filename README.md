# dwscan
PowerShell script for scanning pc's for viruses with DrWeb

Суть работы:
1.	Нужно создать текстовый файл со списком хостов для проверки (одна строка – одно имя хоста)
2.	Скрипт запускается с правами админской учётки
3.	Первый диалог предлагает выбрать файл со списком хостов для проверки
4.	Второй диалог приглашает выбрать, где лежит psexec.exe
5.	Скрипт проверяет хосты на доступность по ping (Test-NetConnection)
6.	Далее проверяется на доступность подключения psexec (функцию взял из мега-скрипта Дениса Яресько)
7.	Следующий шаг – проверяется наличие DrWeb на хосте (Test-Path)
8.	Если все ОК, то проверяется наличие папки C:\Distr\DoctorWebScanResults, если ее нет, она создается
9.	Запускается проверка с ключами «/QUIT /FULL /AA /RA: "C:\distr\DoctorWebScanResults\$date.log"», то есть сканер закроется автоматом по окончании проверки, полная проверка, автоматическое применение действий антивируса, файл отчета сохранится в папку C:\Distr\DoctorWebScanResults c именем в формате dd-MM-yyyy.log
10.	Результаты запуска скрипта – это лог файл в папке, откуда скрипт запускался с именем в формате HH-mm-ss dd-MM-yyyy.txt, куда помещается информация о доступности хоста по сети, доступности psexec и наличии dwscanner.exe на хосте
11.	Результаты сканирования лежат на каждом хосте отдельно в указанной выше папке

Что еще нужно реализовать: 
1.	Обработка логов проверки с хостов (файлы получаются огромные, нужно придумать лайтовое решение) и сохранение результатов в удобной форме
2.	Мониторинг хода выполнения проверки на хостах – маст хэв, как мне кажется
3.	Еще что-нибудь наверняка потребуется
